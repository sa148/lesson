<!DOCTYPE html>
<html>
<head>
<script type="text/javascript">
function getStringById(id) {
  var element = document.getElementById(id);
  return element.innerHTML;
}
</script>
</head>
<body>
<div id="area1">
<pre>
　　 ＿＿＿＿＿＿＿＿　　　　　　　　　　　　　＿＿＿＿＿＿＿＿
　 （＿＿＿＿＿　　　 ＼　　　　 ⊂⊃　　　　／　　　　＿＿＿＿）
　　　　（＿＿＿＿＿　　＼　　　∧＿∧　　 ／　　　＿＿＿＿）
　　　　　　　（＿＿＿＿　＼ （　´∀｀）／　＿＿＿＿）
　　　　　　　　　　（＿＿＿__⊂　　　 ⊃＿＿＿＿）
　　　　　　　　　　　　　　　 ｜ ｜ ｜
　　　　　　　　　　　　　　　（＿_）＿）
</pre>
</div>
<br>
 
<div id="area2"></div>
<script type="text/javascript">
function encodeRunLength(data) {
  var encode_data = new Array();
  var c;
  var len = 0;
 
for (var i = 0; i < data.length; i++) {
  if ((0 < len) && (len<9) && (c == data.charAt(i))) {
    len++;
    continue;
  }
 
  if(len != 0) {
    encode_data.push(c);
    encode_data.push(len);
  }
 
  c = data.charAt(i);
  len = 1;
  }
 
  if(len != 0) {
    encode_data.push(c);
    encode_data.push(len);
  }
 
  return encode_data;
}
 
function decodeRunLength(data) {
  var decode_data = new Array();
 
  for (var i = 0; i<data.length; i++) {
    if ((i%2) != 0) { continue; }
    var c = data[i];
    var num = parseInt(data[i+1]);
    if (isNaN(num)) { return null; }
    for (var j = 0; j < num; j++) {
    decode_data.push(c);
    }
  }
  return decode_data;
}
 
function execRunLength(input,output) {
  var data = getStringById(input);
  var element = document.getElementById(output);
  element.innerHTML = "元のデータ量: " + data.length + "<br>";
 
  var encode_data = encodeRunLength(data);
  if (encode_data == null) { return; }
 
  element.innerHTML += "圧縮しました。<br/>";
  element.innerHTML += "圧縮後のデータ量: " + encode_data.length + "<br/>";
  element.innerHTML += "データを復元します。<br/>";
 
  var decode_data = decodeRunLength(encode_data);
  if (decode_data == null) { return; }
 
  element.innerHTML += decode_data.join("");
  element.innerHTML += "<br/>圧縮率: ";
  element.innerHTML += parseInt(encode_data.length / data.length * 100);
  element.innerHTML += "%<br/>";
}
</script>
<input type="button" onClick="execRunLength('area1','area2');" value="RunLength">
<br><!-- 末尾1 -->
</body>
</html>